import csv

data = []

def transform_row(row):
    title = line[0]
    release_date = int(line[1])
    director = line[2]

    return [

        # column 1
        title,

        # column 2: subtract 1000 from the year
        release_date - 1000,

        # column 4: empty column
        None,

        # column 3
        director
    ]

# read csv file line by line
with open('input.csv', 'rb') as f:
    reader = csv.reader(f)

    # pop header row (1st row in csv)
    header = reader.next()

    # loop through each line in csv and transform
    for line in reader:

        # if the line is blank, skip this and keep going
        if not line: continue

        data.append(transform_row(line))

# write a new csv file
with open('output.csv', 'w') as f:
    # define new csv writer
    writer = csv.writer(f, delimiter=',')

    # write a header row to our output.csv file
    writer.writerow([
        'Title',
        'Date minus 1000',
        None,
        'Director'
    ])

    # write our data to the file
    writer.writerows(data)
